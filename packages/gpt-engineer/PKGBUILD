# Maintainer: brokenpip3 <brokenpip3[at]gmail[dot]com>
# https://github.com/brokenpip3/my-pkgbuilds

pkgname=gpt-engineer
_name=gpt_engineer
pkgver=0.2.3
pkgrel=1
pkgdesc="Specify what you want it to build, the AI asks for clarification, and then builds it."
arch=('any')
url="https://github.com/AntonOsika/gpt-engineer"
license=('MIT')
depends=(python-openai python-termcolor python-typer python-dataclasses-json python-tiktoken python-tabulate python-dotenv python-langchain)
makedepends=(python-build python-installer python-poetry-core)
#checkdepends=(python-pytest)
install=gpt-engineer.install
source=("https://files.pythonhosted.org/packages/source/${pkgname::1}/$pkgname/$_name-$pkgver.tar.gz")
sha256sums=('79f8c468ae8638ec4e8c0a3a42ee76f8ebddf99e2c175478b48a1706bf9202f8')


build() {
    cd "$pkgname-$pkgver"
    python -m build --wheel --no-isolation
}

package() {
    cd "$pkgname-$pkgver"
    python -m installer --destdir="$pkgdir" dist/*.whl
}

# Disabled due to rudder-sdk-python dependency
# https://github.com/AntonOsika/gpt-engineer/commit/f159dc45f2dccfa7c1f5b4d8290e168d48175104
#check() {
#    cd "$pkgname-$pkgver"
#    pytest .
#}
